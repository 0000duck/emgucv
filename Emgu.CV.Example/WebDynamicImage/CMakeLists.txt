PROJECT(Example.WebDynamicImage)

GET_TARGET_PROPERTY(OPENCV_CORE_LOCATION opencv_core LOCATION)
GET_TARGET_PROPERTY(OPENCV_IMGPROC_LOCATION opencv_imgproc LOCATION)
GET_TARGET_PROPERTY(OPENCV_HIGHGUI_LOCATION opencv_highgui LOCATION)
GET_TARGET_PROPERTY(OPENCV_OBJDETECT_LOCATION opencv_objdetect LOCATION)
GET_TARGET_PROPERTY(CVEXTERN_LOCATION cvextern LOCATION)
GET_TARGET_PROPERTY(OPENCV_ML_LOCATION opencv_ml LOCATION)

###################################################################
# Work around for GET_TARGET_PROPERTY LOCATION bug
###################################################################
GET_FILENAME_COMPONENT(OPENCV_CORE_LOCATION ${OPENCV_CORE_LOCATION} NAME)
GET_FILENAME_COMPONENT(OPENCV_IMGPROC_LOCATION ${OPENCV_IMGPROC_LOCATION} NAME)
GET_FILENAME_COMPONENT(OPENCV_HIGHGUI_LOCATION ${OPENCV_HIGHGUI_LOCATION} NAME)
GET_FILENAME_COMPONENT(OPENCV_OBJDETECT_LOCATION ${OPENCV_OBJDETECT_LOCATION} NAME)
GET_FILENAME_COMPONENT(CVEXTERN_LOCATION ${CVEXTERN_LOCATION} NAME)
GET_FILENAME_COMPONENT(OPENCV_ML_LOCATION ${OPENCV_ML_LOCATION} NAME)
SET(OPENCV_CORE_LOCATION "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/${OPENCV_CORE_LOCATION}")
SET(OPENCV_IMGPROC_LOCATION "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/${OPENCV_IMGPROC_LOCATION}")
SET(OPENCV_HIGHGUI_LOCATION "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/${OPENCV_HIGHGUI_LOCATION}")
SET(OPENCV_OBJDETECT_LOCATION "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/${OPENCV_OBJDETECT_LOCATION}")
SET(CVEXTERN_LOCATION "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/${CVEXTERN_LOCATION}")
SET(OPENCV_ML_LOCATION "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/${OPENCV_ML_LOCATION}")

ADD_CUSTOM_TARGET(
   ${PROJECT_NAME} ALL
   COMMAND ${CMAKE_COMMAND} -E copy ${OPENCV_CORE_LOCATION} ${CMAKE_CURRENT_SOURCE_DIR}/Bin
   COMMAND ${CMAKE_COMMAND} -E copy ${OPENCV_IMGPROC_LOCATION} ${CMAKE_CURRENT_SOURCE_DIR}/Bin
   COMMAND ${CMAKE_COMMAND} -E copy ${OPENCV_OBJDETECT_LOCATION} ${CMAKE_CURRENT_SOURCE_DIR}/Bin
   COMMAND ${CMAKE_COMMAND} -E copy ${OPENCV_HIGHGUI_LOCATION} ${CMAKE_CURRENT_SOURCE_DIR}/Bin
   COMMAND ${CMAKE_COMMAND} -E copy ${CVEXTERN_LOCATION} ${CMAKE_CURRENT_SOURCE_DIR}/Bin
   COMMAND ${CMAKE_COMMAND} -E copy ${OPENCV_ML_LOCATION} ${CMAKE_CURRENT_SOURCE_DIR}/Bin
)
ADD_DEPENDENCIES(${PROJECT_NAME} Emgu.CV Emgu.CV.UI opencv_core opencv_imgproc opencv_highgui opencv_objdetect opencv_ml cvextern)


